010 PRINT "*** requires Atari XL machine to run ***"
020 PRINT "*** THE FLAG VERIFICATOR: LEVEL 4 ***"
030 PRINT "FLAG FORMAT: FLAG{[A-Z0-9_!]*}"
040 PREFIX=5 : FL=60 : SL=12
050 DIM U$(PREFIX+FL+1), F(FL), S(SL)
060 REM *** LOAD SUBROUTINE ***
070 FOR I=0 TO 27
080 READ DAT:POKE 1536+I,DAT
090 NEXT I
095 REM *** LOAD SK ***
100 FOR I=1 TO SL
110 READ S : S(I)=S
115 NEXT I
120 PRINT "FLAG"; : INPUT U$
140 IF LEN(U$)<>PREFIX+FL+1 THEN GOTO 600
150 FOR J=1 TO FL
160 READ T : F(J)=T
170 NEXT J
400 FOR I=1 TO INT(FL/SL)
410 FOR J=1 TO SL
420 K=SL*(I-1)+J
430 Z=USR(1536,S(J),ASC(U$(K+PREFIX)))
440 IF Z<>F(K) THEN GOTO 600
450 NEXT J
460 NEXT I
500 PRINT "GOOD JOB! NOW SUBMIT THE FLAG." : END
600 RESTORE
610 PRINT "THE PROVIDED FLAG IS INVALID TRY ANONTHER" : GOTO 60
900 REM *** XOR SUBROUTINE IMPLEMENTED IN ASM ***
901 DATA 104,216,104,133,204,104,133,203,104,133
902 DATA 207,104,133,206,24,165,203,69,206,133
903 DATA 212,165,204,69,207,133,213,96
904 DATA 72,69,76,76,79,71,89,78,86,65,69,76
905 REM *** ENCRYPTED DATA ***
910 DATA 24,0,30,10,10,4,13,17,5,4,6,30
920 DATA 13,6,21,19,24,14,13,6,9,4,29,15
930 DATA 4,16,31,5,25,2,6,10,31,18,15,25
940 DATA 6,6,24,5,0,9,6,15,24,5,26,3
950 DATA 6,0,19,24,6,10,28,17,6,0,1,109

